<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.6.0 for Hugo"><meta name=author content="Anıl Zenginoğlu"><meta name=description content="This is the first installment of a three-piece series on Penrose diagrams and the associated conformal compactification procedure. This post is a technical how-to describing how I draw quantitatively accurate Penrose diagrams to illustrate the causal structure of time surfaces using the LaTeX library TikZ."><link rel=alternate hreflang=en-us href=https://hyperboloid.al/post/drawing-penrose-diagrams/><meta name=theme-color content="#1565c0"><script src=/js/mathjax-config.js></script>
<link rel=stylesheet href=/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script>
<link rel=stylesheet href=/css/wowchemy.5707bae28a49ccd4e72ceb69e62e6fe1.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><script async src="https://www.googletagmanager.com/gtag/js?id=G-XHRCPC2W1J"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(e,t){gtag("event","click",{event_category:"outbound",event_label:e,transport_type:"beacon",event_callback:function(){t!=="_blank"&&(document.location=e)}}),console.debug("Outbound link clicked: "+e)}function onClickCallback(e){if(e.target.tagName!=="A"||e.target.host===window.location.host)return;trackOutboundLink(e.target,e.target.getAttribute("target"))}gtag("js",new Date),gtag("config","G-XHRCPC2W1J",{}),gtag("set",{cookie_flags:"SameSite=None;Secure"}),document.addEventListener("click",onClickCallback,!1)</script><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_huee6cfb656ad77a41edf7471c8d890b5c_102772_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_huee6cfb656ad77a41edf7471c8d890b5c_102772_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://hyperboloid.al/post/drawing-penrose-diagrams/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@hyperboloidal_"><meta property="twitter:creator" content="@hyperboloidal_"><meta property="og:site_name" content="Hyperboloidal"><meta property="og:url" content="https://hyperboloid.al/post/drawing-penrose-diagrams/"><meta property="og:title" content="How to draw Penrose diagrams | Hyperboloidal"><meta property="og:description" content="This is the first installment of a three-piece series on Penrose diagrams and the associated conformal compactification procedure. This post is a technical how-to describing how I draw quantitatively accurate Penrose diagrams to illustrate the causal structure of time surfaces using the LaTeX library TikZ."><meta property="og:image" content="https://hyperboloid.al/post/drawing-penrose-diagrams/featured.png"><meta property="twitter:image" content="https://hyperboloid.al/post/drawing-penrose-diagrams/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-08-26T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-26T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hyperboloid.al/post/drawing-penrose-diagrams/"},"headline":"How to draw Penrose diagrams","image":["https://hyperboloid.al/post/drawing-penrose-diagrams/featured.png"],"datePublished":"2022-08-26T00:00:00Z","dateModified":"2022-08-26T00:00:00Z","author":{"@type":"Person","name":"anil"},"publisher":{"@type":"Organization","name":"Hyperboloidal","logo":{"@type":"ImageObject","url":"https://hyperboloid.al/media/logo_huee6cfb656ad77a41edf7471c8d890b5c_102772_192x192_fit_lanczos_3.png"}},"description":"This is the first installment of a three-piece series on Penrose diagrams and the associated conformal compactification procedure. This post is a technical how-to describing how I draw quantitatively accurate Penrose diagrams to illustrate the causal structure of time surfaces using the LaTeX library TikZ."}</script><title>How to draw Penrose diagrams | Hyperboloidal</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=d6602bd077a464bb10ed4c43affd87b9><script src=/js/wowchemy-init.min.1ee5462d74c6c0de1f8881b384ecc58d.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><header class=header--fixed><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo_huee6cfb656ad77a41edf7471c8d890b5c_102772_0x70_resize_lanczos_3.png alt=Hyperboloidal></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo_huee6cfb656ad77a41edf7471c8d890b5c_102772_0x70_resize_lanczos_3.png alt=Hyperboloidal></a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/post><span>Blog</span></a></li><li class=nav-item><a class=nav-link href=/people><span>People</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>How to draw Penrose diagrams</h1><p class=page-subtitle>with free and open-source software (TikZ and Python).</p><div class=article-metadata><div><span><a href=/author/anil/>anil</a></span></div><span class=article-date>Aug 26, 2022</span>
<span class=middot-divider></span>
<span class=article-reading-time>10 min read</span>
<span class=middot-divider></span>
<span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/category/tutorial/>Tutorial</a></span></div></div><div class=article-container><div class=article-style><p>The <a href=https://en.wikipedia.org/wiki/Penrose_diagram target=_blank rel=noopener>Penrose diagram</a> is a valuable tool in relativity to illustrate the global causal structure of spacetimes<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. If you&rsquo;re mainly interested illustrating the essential causal relationships, qualitative diagrams may be sufficient. But for numerical work, it may be important to draw quantitatively correct diagrams.</p><p>Below, I show how to draw Penrose diagrams using the LaTeX package TikZ, which <a href=https://en.wikipedia.org/wiki/PGF/TikZ target=_blank rel=noopener>is not a drawing program</a> but a program that draws<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. We&rsquo;ll use Python to perform transformations when we hit the computational limitations of TikZ.</p><div class="alert alert-note"><div>TikZ codes for all diagrams below are on my <a href=https://github.com/anilzen/anilzen.github.io/tree/main/content/post/2022/drawing-penrose-diagrams/tikz target=_blank rel=noopener>website repository</a>.</div></div><h3 id=the-basic-idea-behind-penrose-diagrams>The basic idea behind Penrose diagrams</h3><p>The Penrose diagram is an extension, or better, a <em>completion</em> of the <a href=https://en.wikipedia.org/wiki/Spacetime_diagram target=_blank rel=noopener>Minkowski diagram</a>. Just like in the Minkowski diagram, time is vertical, space is horizontal, and null rays are at 45 degrees to the axes. In contrast to the Minkowski diagram, a Penrose diagram includes &ldquo;points at infinity&rdquo; added by compactification, thereby visualizing the rich structure of infinity arising from the unification of space and time.</p><p>Below are two beautiful <a href=https://tikz.net/relativity_penrose_diagram/ target=_blank rel=noopener>TikZ diagrams</a> by <a href=https://www.physik.uzh.ch/en/researcharea/cms/people/Izaak-Neutelings.html target=_blank rel=noopener>Izaak Neutelings</a>. On the left is the Minkowski diagram. Spacetime extends infinitely in all directions. On the right is the Penrose diagram, which represents the entire spacetime in a finite square.</p><table><thead><tr><th style=text-align:center></th><th style=text-align:center></th></tr></thead><tbody><tr><td style=text-align:center><figure id=figure-minkowski-diagramhttpstikznetrelativity_penrose_diagram><div class="d-flex justify-content-center"><div class=w-100><img alt="[Minkowski diagram](https://tikz.net/relativity_penrose_diagram/)" srcset="/post/drawing-penrose-diagrams/figures/neutelings_minkowski_hub48f7d8ad14fbf2ddf097172b8405b3c_351951_00daccc019c1c8e7d5b53f79e0e59c99.webp 400w,
/post/drawing-penrose-diagrams/figures/neutelings_minkowski_hub48f7d8ad14fbf2ddf097172b8405b3c_351951_463aa2ce8f62b82dc39936265db730ef.webp 760w,
/post/drawing-penrose-diagrams/figures/neutelings_minkowski_hub48f7d8ad14fbf2ddf097172b8405b3c_351951_1200x1200_fit_q75_h2_lanczos.webp 1200w" src=/post/drawing-penrose-diagrams/figures/neutelings_minkowski_hub48f7d8ad14fbf2ddf097172b8405b3c_351951_00daccc019c1c8e7d5b53f79e0e59c99.webp width=760 height=626 loading=lazy data-zoomable></div></div><figcaption><a href=https://tikz.net/relativity_penrose_diagram/ target=_blank rel=noopener>Minkowski diagram</a></figcaption></figure></td><td style=text-align:center><figure id=figure-penrose-diagramhttpstikznetrelativity_penrose_diagram><div class="d-flex justify-content-center"><div class=w-100><img alt="[Penrose Diagram](https://tikz.net/relativity_penrose_diagram/)" srcset="/post/drawing-penrose-diagrams/figures/neutelings_penrose_hud64c81516ee3adbf604a4e1198a47bf6_845479_ac06b1fd002695e2e4dc0081a38f765b.webp 400w,
/post/drawing-penrose-diagrams/figures/neutelings_penrose_hud64c81516ee3adbf604a4e1198a47bf6_845479_6a8d1b9f9b8453134e80447669cc1564.webp 760w,
/post/drawing-penrose-diagrams/figures/neutelings_penrose_hud64c81516ee3adbf604a4e1198a47bf6_845479_1200x1200_fit_q75_h2_lanczos.webp 1200w" src=/post/drawing-penrose-diagrams/figures/neutelings_penrose_hud64c81516ee3adbf604a4e1198a47bf6_845479_ac06b1fd002695e2e4dc0081a38f765b.webp width=760 height=661 loading=lazy data-zoomable></div></div><figcaption><a href=https://tikz.net/relativity_penrose_diagram/ target=_blank rel=noopener>Penrose Diagram</a></figcaption></figure></td></tr></tbody></table><p>The Minkowski diagram on the left is mapped to the Penrose diagram on the right. Compactification maps the null directions to a finite interval. Penrose used the inverse tangent function in his original papers but many other choices exist. We will play with them to illustrate some coordinate-dependent features in these diagrams.</p><h3 id=minkowski-spacetime>Minkowski spacetime</h3><p>Consider the 4-dimensional Minkowski spacetime with standard spherical coordinates: $t \in (-\infty,\infty)$, $r \in [0,\infty)$, $\theta\in[0,\pi]$, $\varphi\in[0,2\pi)$. The metric reads
$$ ds^2 = -dt^2 + dr^2 + r^2 d\sigma^2, $$
where $d\sigma^2=d\theta^2+\sin^2\theta d\varphi^2$, the standard metric on the unit sphere. Penrose diagrams are two-dimensional, so we essentially ignore the angular coordinates (each point, except the origin, represents a sphere). Spherical light rays propagate along the directions $t+r$ and $t-r$. These directions are called <a href=https://en.wikipedia.org/wiki/Null_vector target=_blank rel=noopener>null</a> because they are in the <a href=https://en.wikipedia.org/wiki/Kernel_%28linear_algebra%29 target=_blank rel=noopener>nullspace</a> of the metric.</p><p>The core element of Penrose diagrams are coordinates, $T$ and $R$, which compactify these null directions:
$$ T+R = \frac{2}{\pi}\textcolor{DarkOrchid}{\arctan}(t+r),$$
$$ T-R = \frac{2}{\pi}\textcolor{DarkOrchid}{\arctan}(t-r). $$
The mapped range of the coordinates is $T\in(-1,1)$ and $R\in[0,1)$. Note that I&rsquo;m not including the endpoints in the intervals yet. The Penrose compactification procedure involves the conformal completion of the spacetime which adds the points at infinity after a regularizing rescaling. This detail is not relevant for the diagrams but is important for geometry.</p><p>The Penrose coordinates $(T,R)$ read in terms of the standard $(t,r)$ as:
$$ T(t,r) = \frac{1}{\pi}\left( \arctan(t+r) + \arctan(t-r) \right)$$
$$ R(t,r) = \frac{1}{\pi}\left( \arctan(t+r) - \arctan(t-r) \right)$$</p><p>Let&rsquo;s make some plots. I&rsquo;ll demonstrate plotting time surfaces (level sets of a time coordinate). Say, you&rsquo;d like to draw constant $t$ surfaces in the Penrose diagram. You might be tempted to solve the above relationships for a graph function $T(R;t)$ with constant $t$. But it is easier to let the machine do the work and plot the surfaces parametrically. Define the functions $T(t,r)$ and $R(t,r)$ in TikZ as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-latex data-lang=latex><span class=line><span class=cl><span class=k>\tikzset</span><span class=nb>{</span>declare function=<span class=nb>{</span>
</span></span><span class=line><span class=cl>    T(<span class=k>\t</span>,<span class=k>\r</span>)  = <span class=k>\fpeval</span><span class=nb>{</span>1/pi*(atan(<span class=k>\t</span>+<span class=k>\r</span>) + atan(<span class=k>\t</span>-<span class=k>\r</span>))<span class=nb>}</span>;
</span></span><span class=line><span class=cl>    R(<span class=k>\t</span>,<span class=k>\r</span>)  = <span class=k>\fpeval</span><span class=nb>{</span>1/pi*(atan(<span class=k>\t</span>+<span class=k>\r</span>) - atan(<span class=k>\t</span>-<span class=k>\r</span>))<span class=nb>}</span>;
</span></span><span class=line><span class=cl><span class=nb>}}</span>
</span></span></code></pre></div><p>Then, plot the lines parametrically.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-latex data-lang=latex><span class=line><span class=cl><span class=k>\def\Nlines</span><span class=nb>{</span>6<span class=nb>}</span> <span class=c>% total number of lines is 2\Nlines+1
</span></span></span><span class=line><span class=cl><span class=c></span><span class=k>\newcommand\samp</span><span class=na>[1]</span><span class=nb>{</span> tan(90*#1) <span class=nb>}</span> <span class=c>% for equidistant sampling 
</span></span></span><span class=line><span class=cl><span class=c></span><span class=k>\foreach</span> <span class=k>\i</span> [evaluate=<span class=nb>{</span><span class=k>\t</span>=<span class=k>\i</span>/(<span class=k>\Nlines</span>+1);<span class=nb>}</span>] in <span class=nb>{</span>-<span class=k>\Nlines</span>,...,<span class=k>\Nlines</span><span class=nb>}{</span>
</span></span><span class=line><span class=cl>    <span class=k>\message</span><span class=nb>{</span>Drawing i=<span class=k>\i</span>...<span class=nb>^^</span>J<span class=nb>}</span>
</span></span><span class=line><span class=cl>    <span class=k>\draw</span><span class=na>[line width=0.3,samples=30,smooth,variable=\r,domain=0.001:1]</span>
</span></span><span class=line><span class=cl>    plot(<span class=nb>{</span> R(<span class=k>\samp</span><span class=nb>{</span><span class=k>\t</span><span class=nb>}</span>,<span class=k>\samp</span><span class=nb>{</span><span class=k>\r</span><span class=nb>}</span>) <span class=nb>}</span>, <span class=nb>{</span> T(<span class=k>\samp</span><span class=nb>{</span><span class=k>\t</span><span class=nb>}</span>,<span class=k>\samp</span><span class=nb>{</span><span class=k>\r</span><span class=nb>}</span>) <span class=nb>}</span>);
</span></span><span class=line><span class=cl><span class=nb>}</span>
</span></span></code></pre></div><p>A neat trick I got from <a href=https://tikz.net/relativity_penrose_diagram/ target=_blank rel=noopener>Neutelings</a> is the sampling of points by incorporating the compactification into the plot function. As you can see in the diagrams below, the time surfaces are equally separated from each other at the origin. The function <code>samp</code> controls the separation of points in the plot.</p><table><thead><tr><th style=text-align:center></th><th style=text-align:center></th></tr></thead><tbody><tr><td style=text-align:center><figure id=figure-compactification-with-arctan-filetikzminkmink_arctantex><div class="d-flex justify-content-center"><div class=w-100><img alt="Compactification with arctan [(file)](tikz/mink/mink_arctan.tex)" srcset="/post/drawing-penrose-diagrams/figures/mink_arctan_hu0ed202cf971a20ea79ed5ddc7d6a4c2f_63882_7c87c5b70173cea05b03cb6ef62b45e7.webp 400w,
/post/drawing-penrose-diagrams/figures/mink_arctan_hu0ed202cf971a20ea79ed5ddc7d6a4c2f_63882_4eb7334e9c0a75b4d551c2668a6b69ba.webp 760w,
/post/drawing-penrose-diagrams/figures/mink_arctan_hu0ed202cf971a20ea79ed5ddc7d6a4c2f_63882_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/drawing-penrose-diagrams/figures/mink_arctan_hu0ed202cf971a20ea79ed5ddc7d6a4c2f_63882_7c87c5b70173cea05b03cb6ef62b45e7.webp width=438 height=760 loading=lazy data-zoomable></div></div><figcaption>Compactification with arctan <a href=tikz/mink/mink_arctan.tex>(file)</a></figcaption></figure></td><td style=text-align:center><figure id=figure-compactification-with-tanh-filetikzminkmink_tanhtex><div class="d-flex justify-content-center"><div class=w-100><img alt="Compactification with tanh [(file)](tikz/mink/mink_tanh.tex)" srcset="/post/drawing-penrose-diagrams/figures/mink_tanh_hu39a38b3c1d47f28d8ceb9cd1fe0fce12_61420_843cb384a6441847b2660c6b3d4b8f27.webp 400w,
/post/drawing-penrose-diagrams/figures/mink_tanh_hu39a38b3c1d47f28d8ceb9cd1fe0fce12_61420_b04b00b0785f30a374e685c6722f9527.webp 760w,
/post/drawing-penrose-diagrams/figures/mink_tanh_hu39a38b3c1d47f28d8ceb9cd1fe0fce12_61420_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/drawing-penrose-diagrams/figures/mink_tanh_hu39a38b3c1d47f28d8ceb9cd1fe0fce12_61420_843cb384a6441847b2660c6b3d4b8f27.webp width=438 height=760 loading=lazy data-zoomable></div></div><figcaption>Compactification with tanh <a href=tikz/mink/mink_tanh.tex>(file)</a></figcaption></figure></td></tr></tbody></table><p>I plotted two versions of the diagram to illustrate a coordinate-dependent feature that confuses even the experts. On both diagrams, the $t$ surfaces intersect at spatial infinity, $i^0$. On the left diagram, they are tangent to each other, while on the right diagram they are not. The intersection of the $t$ surfaces is an invariant feature, but their behavior near $i^0$ on the Penrose diagram depends on coordinates. The left diagram uses the tangens function for compactification but there are many other functions that map an infinite domain to a finite domain. Using the hyperbolic tangens, the mapping reads
$$ T+R = \textcolor{DarkOrchid}{\tanh}(t+r),$$
$$ T-R = \textcolor{DarkOrchid}{\tanh}(t-r). $$
This mapping gives the diagram on the right panel where $t$ surfaces are not tangential at spatial infinity. But there&rsquo;s a subtlety here. Conformal compactification with hyperbolic tangens is not regular when you include the angular dimensions. So be careful what you choose for the mapping.</p><p>I draw Penrose diagrams typically to present the causal structure of hyperboloidal surfaces. Such surfaces behave like spacetime hyperboloids: they are spacelike everywhere, including null horizons. In the literature, spacetime hyperboloids are typically defined by the level sets of $\tau$ as
$$ t^2 - r^2 = \tau^2. $$
This construction appears in many models, such as the <a href=https://en.wikipedia.org/wiki/Milne_model target=_blank rel=noopener>Milne model</a> of cosmology, <a href=https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.21.392 target=_blank rel=noopener>Dirac&rsquo;s point-form</a> of relativistic dynamics, the <a href=https://arxiv.org/abs/hep-th/0303006 target=_blank rel=noopener>de Boer-Solodukhin</a> holography of Minowski spacetime, and the <a href=https://arxiv.org/abs/1304.2794 target=_blank rel=noopener>Buchholz-Roberts framework</a> of relativistic QED.</p><p>However, these surfaces are not generally useful to study evolution in time because they intersect at future null infinity. It is not immediately obvious from their definition that they do intersect at null infinity if you don&rsquo;t know to look for it. But on the Penrose diagram below, one immediately sees the intersection.</p><table><thead><tr><th style=text-align:center></th><th style=text-align:center></th></tr></thead><tbody><tr><td style=text-align:center><figure id=figure-intersecting-hyperbolic-slicing-filetikzminkmink_hypal_intersecttex><div class="d-flex justify-content-center"><div class=w-100><img alt="Intersecting hyperbolic slicing [(file)](./tikz/mink/mink_hypal_intersect.tex)" srcset="/post/drawing-penrose-diagrams/figures/mink_hypal_intersect_hu7747645cf07242a4588871dffffb0c08_48436_5332b674093f643b42a9357e1afcba7a.webp 400w,
/post/drawing-penrose-diagrams/figures/mink_hypal_intersect_hu7747645cf07242a4588871dffffb0c08_48436_85dcb9c9c06ca82a3c6b36b23a9bc33a.webp 760w,
/post/drawing-penrose-diagrams/figures/mink_hypal_intersect_hu7747645cf07242a4588871dffffb0c08_48436_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/drawing-penrose-diagrams/figures/mink_hypal_intersect_hu7747645cf07242a4588871dffffb0c08_48436_5332b674093f643b42a9357e1afcba7a.webp width=440 height=760 loading=lazy data-zoomable></div></div><figcaption>Intersecting hyperbolic slicing <a href=./tikz/mink/mink_hypal_intersect.tex>(file)</a></figcaption></figure></td><td style=text-align:center><figure id=figure-smooth-hyperboloidal-foliation-filetikzminkmink_hypal_foliationtex><div class="d-flex justify-content-center"><div class=w-100><img alt="Smooth hyperboloidal foliation [(file)](tikz/mink/mink_hypal_foliation.tex)" srcset="/post/drawing-penrose-diagrams/figures/mink_hypal_foliation_hu3f5b5c63b3b9a07f4845771a0daebf93_45539_18631d5485c16d6c7c2bc7be7aaf3eb5.webp 400w,
/post/drawing-penrose-diagrams/figures/mink_hypal_foliation_hu3f5b5c63b3b9a07f4845771a0daebf93_45539_a4bae7e0f37eb8922bfaa8622f12bf45.webp 760w,
/post/drawing-penrose-diagrams/figures/mink_hypal_foliation_hu3f5b5c63b3b9a07f4845771a0daebf93_45539_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/drawing-penrose-diagrams/figures/mink_hypal_foliation_hu3f5b5c63b3b9a07f4845771a0daebf93_45539_18631d5485c16d6c7c2bc7be7aaf3eb5.webp width=457 height=760 loading=lazy data-zoomable></div></div><figcaption>Smooth hyperboloidal foliation <a href=tikz/mink/mink_hypal_foliation.tex>(file)</a></figcaption></figure></td></tr></tbody></table><p>A better option for a foliation of Minkowski spacetime, illustrated on the right panel above, is to fix a hyperboloid, say, with unit radius, and shift it in time by $\tau$, like this
$$ (t-\tau)^2 - r^2 = 1 \implies \tau = t \pm \sqrt{1+r^2}. $$
Choosing the minus sign gives a future hyperboloidal foliation. You can see on the diagram at the right panel that the surfaces do not intersect but provide a smooth foliation of future null infinity.</p><p>The causal structure of the time surfaces may not be immediately clear from the formulas. For example, many people find it counterintuitive that hyperboloidal surfaces are spacelike at null infinity or that standard time surfaces intersect at spatial infinity. We can demonstrate such properties by calculations, but it&rsquo;s much easier to view them on a Penrose diagram.</p><h4 id=reading-data-into-tikz>Reading data into TikZ</h4><p>TikZ is limited in its data processing capabilities. As a consequence, the evaluation of the lines in the plots takes a while. Once you move away from Minkowski spacetime, the transformations become too complicated for TikZ. To handle complicated mathematical transformations, you can generate the data for the plots in Python, write them in a file, and plot them with TikZ. Below is the Python code to generate the data files for each time surface.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mf>2.</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=n>endpoint</span><span class=o>=</span><span class=kc>False</span><span class=p>)[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=p>,</span><span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>penrose_coords</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=n>t</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span> <span class=o>=</span> <span class=mf>1.</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>*</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>t</span><span class=o>+</span><span class=n>r</span><span class=p>)</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>t</span><span class=o>-</span><span class=n>r</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>T</span> <span class=o>=</span> <span class=mf>1.</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>*</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>t</span><span class=o>+</span><span class=n>r</span><span class=p>)</span><span class=o>+</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>t</span><span class=o>-</span><span class=n>r</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>R</span><span class=p>,</span><span class=n>T</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>t_val</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>t</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span><span class=p>,</span><span class=n>T</span> <span class=o>=</span> <span class=n>penrose_coords</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>r</span><span class=p>),</span><span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>t_val</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>np</span><span class=o>.</span><span class=n>savetxt</span><span class=p>(</span><span class=s1>&#39;arctan_data&#39;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=o>+</span><span class=s1>&#39;.csv&#39;</span><span class=p>,</span><span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>((</span><span class=n>R</span><span class=p>,</span><span class=n>T</span><span class=p>))</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>delimiter</span><span class=o>=</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%f</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>header</span><span class=o>=</span><span class=s2>&#34;R,T&#34;</span><span class=p>,</span> <span class=n>comments</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>You&rsquo;ll need the <a href=https://numpy.org/ target=_blank rel=noopener>numpy</a> library installed in your environment (use <a href=https://xkcd.com/1987/ target=_blank rel=noopener>local environments for Python!</a> The array <code>t</code> contains the constant values of the time surfaces; the array <code>r</code> includes the samples of the plot parameter. The domains stop at $\pi/2$ because we use the $\tan$ function to sample the points for a relatively even distribution. Then, for each value of <code>t</code>, we write the $R,T$ coordinates into a CSV file with headers and some formatting.</p><p>On the TikZ side, we simply read these points from the respective files and plot them. To plot data points, I use the library <code>pgfplots</code>. The nodes must be drawn with respect to the axis of the plot, which is achieved with the <code>axis cs:</code> directive. The relevant part of the code is below.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-latex data-lang=latex><span class=line><span class=cl> <span class=k>\begin</span><span class=nb>{</span>axis<span class=nb>}</span>[axis lines=none, xmin=-.1,xmax=1.1,ymin=-1.2,ymax=1.2,width=0.5<span class=k>\textwidth</span>,height=0.8<span class=k>\textwidth</span>]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>\node</span><span class=na>[right]</span> at (axis cs:0.6,1) <span class=nb>{</span><span class=k>\small</span><span class=nb>{</span><span class=s>$</span><span class=nv>\arctan</span><span class=o>(</span><span class=nv>\cdot</span><span class=o>)</span><span class=s>$</span><span class=nb>}}</span>;
</span></span><span class=line><span class=cl>    <span class=k>\coordinate</span> (O) at (axis cs:0,0) ; <span class=c>% center: origin (r,t) = (0,0)
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>\coordinate</span> (S) at ( axis cs:0,-1); <span class=c>% south: t=-infty, i-
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>\coordinate</span> (N) at ( axis cs:0, 1); <span class=c>% north: t=+infty, i+
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>\coordinate</span> (E) at ( axis cs:1, 0); <span class=c>% east:  r=+infty, i0
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>\draw</span><span class=na>[thick]</span> (N) -- (E) -- (S) -- cycle;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>\newcommand</span><span class=nb>{</span><span class=k>\scri</span><span class=nb>}{</span><span class=k>\mathscr</span><span class=nb>{</span>I<span class=nb>}}</span> <span class=c>% null infinity
</span></span></span><span class=line><span class=cl><span class=c></span>    <span class=k>\node</span><span class=na>[right]</span> at (E) <span class=nb>{</span><span class=s>$</span><span class=nb>i^</span><span class=m>0</span><span class=s>$</span><span class=nb>}</span>;
</span></span><span class=line><span class=cl>    <span class=k>\node</span><span class=na>[above]</span> at (N) <span class=nb>{</span><span class=s>$</span><span class=nb>i^</span><span class=o>+</span><span class=s>$</span><span class=nb>}</span>;
</span></span><span class=line><span class=cl>    <span class=k>\node</span><span class=na>[below]</span> at (S) <span class=nb>{</span><span class=s>$</span><span class=nb>i^</span><span class=o>-</span><span class=s>$</span><span class=nb>}</span>;
</span></span><span class=line><span class=cl>    <span class=k>\node</span><span class=na>[above, rotate=90]</span> at (O) <span class=nb>{</span><span class=k>\small</span><span class=nb>{</span><span class=s>$</span><span class=nb>r</span><span class=o>=</span><span class=m>0</span><span class=s>$</span><span class=nb>}}</span>;
</span></span><span class=line><span class=cl>    <span class=k>\node</span><span class=na>[above right]</span> at (axis cs: 0.5,0.5) <span class=nb>{</span><span class=s>$</span><span class=nv>\scri</span><span class=nb>^</span><span class=o>+</span><span class=s>$</span><span class=nb>}</span>;
</span></span><span class=line><span class=cl>    <span class=k>\node</span><span class=na>[below right]</span> at (axis cs: 0.5,-0.5) <span class=nb>{</span><span class=s>$</span><span class=nv>\scri</span><span class=nb>^</span><span class=o>-</span><span class=s>$</span><span class=nb>}</span>;
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>\foreach</span> <span class=k>\file</span> in <span class=nb>{{</span>arctan<span class=nb>_</span>data0.csv<span class=nb>}</span>,<span class=nb>{</span>arctan<span class=nb>_</span>data1.csv<span class=nb>}</span>,<span class=nb>{</span>arctan<span class=nb>_</span>data2.csv<span class=nb>}</span>,<span class=nb>{</span>arctan<span class=nb>_</span>data3.csv<span class=nb>}</span>,
</span></span><span class=line><span class=cl>    			    <span class=nb>{</span>arctan<span class=nb>_</span>data4.csv<span class=nb>}</span>,<span class=nb>{</span>arctan<span class=nb>_</span>data5.csv<span class=nb>}</span>,<span class=nb>{</span>arctan<span class=nb>_</span>data6.csv<span class=nb>}}</span>
</span></span><span class=line><span class=cl>  	  <span class=nb>{</span><span class=k>\addplot</span><span class=na>[domain={-1,1}]</span> table [x=R, y=T, col sep=comma] <span class=nb>{</span><span class=k>\file</span><span class=nb>}</span>;<span class=nb>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>\end</span><span class=nb>{</span>axis<span class=nb>}</span>
</span></span></code></pre></div><p>This is probably not the most elegant solution, but it works. If you&rsquo;re up for it, you might prefer using a Python library such as <a href=https://pypi.org/project/tikzplotlib/ target=_blank rel=noopener>tikzplotlib</a> to avoid going back and forth between Python and TikZ.</p><h3 id=schwarzschild-spacetime>Schwarzschild spacetime</h3><p>The Schwarzschild line element in Droste coordinates reads
$$ ds^2 = - f(r) dt^2 + \frac{1}{f(r)} dr^2 + r^2 d\sigma^2, \tag{SS} \label{1}$$
where
$$ f(r) = 1-\frac{2 M}{r},$$
or in dimensionless coordinates
$$ f(r) = 1-\frac{1}{r}.$$
Dimensionless coordinates are similar to setting $M=1/2$.</p><p>The metric is singular where $f(r)$ vanishes, at $r=1$. This surface is the <a href=https://en.wikipedia.org/wiki/Event_horizon target=_blank rel=noopener>event horizon</a>, but the metric singularity is a coordinate artefact. It is <a href=anilzen.github.io/publication/zenginoglu-2011-geometric/>arguably more natural</a> to use coordinates that are regular across the event horizon, such as the <a href=https://en.wikipedia.org/wiki/Gullstrand%E2%80%93Painlev%C3%A9_coordinates target=_blank rel=noopener>Gullstrand–Painlevé</a> or the <a href=https://en.wikipedia.org/wiki/Eddington%E2%80%93Finkelstein_coordinates target=_blank rel=noopener>Eddington–Finkelstein</a> coordinates. In fact, we must use such coordinates to draw Penrose diagrams.</p><p>Penrose diagrams for Schwarzschild spacetime are traditionally drawn using a compactification of <a href=https://en.wikipedia.org/wiki/Kruskal%E2%80%93Szekeres_coordinates target=_blank rel=noopener>Kruskal coordinates</a>. Let&rsquo;s copy them from Wikipedia (for a derivation, see, for example, the Appendix of my <a href=anilzen.github.io/publication/zenginoglu-2007-conformal/>thesis</a>):
$$ \tau = (r-1) e^r \sinh \tfrac{t}{2}, $$
$$ \rho = (r-1) e^r \cosh \tfrac{t}{2}. $$
The coordinates of the Penrose diagram are compactified along the null directions just as in the Minkowski case:
$$ T = \frac{1}{\pi}\left( \arctan(\tau+\rho) + \arctan(\tau-\rho) \right)$$
$$ R = \frac{1}{\pi}\left( \arctan(\tau+\rho) - \arctan(\tau-\rho) \right)$$
The transformations are more complicated, so we will use Python codes to generate the lines and plot them with TikZ. Here&rsquo;s the Python function to construct the compactified Kruskal coordinates.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>kruskal_coords</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>t</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>rho</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>r</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>r</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>cosh</span><span class=p>(</span><span class=n>t</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tau</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>r</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>r</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>sinh</span><span class=p>(</span><span class=n>t</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span> <span class=o>=</span> <span class=mf>2.</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>*</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>tau</span><span class=o>+</span><span class=n>rho</span><span class=p>)</span><span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>tau</span><span class=o>-</span><span class=n>rho</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>T</span> <span class=o>=</span> <span class=mf>2.</span><span class=o>/</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>*</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>tau</span><span class=o>+</span><span class=n>rho</span><span class=p>)</span><span class=o>+</span><span class=n>np</span><span class=o>.</span><span class=n>arctan</span><span class=p>(</span><span class=n>tau</span><span class=o>-</span><span class=n>rho</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>R</span><span class=p>,</span> <span class=n>T</span>
</span></span></code></pre></div><p>I construct Schwarzschild radial points from tortoise coordinates that are on Chebyshev nodes because I want more points at the end points closer to the horizon and infinity than at the inner points. There are different, possibly more effective ways of achieving such a beneficial point distribution, but this method works sufficiently well for the diagrams.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>t_vals</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=o>-</span><span class=mf>3.</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r_tort</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>tan</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span><span class=o>/</span><span class=mi>2</span><span class=o>*</span><span class=n>np</span><span class=o>.</span><span class=n>cos</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>pi</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span> <span class=o>/</span> <span class=mi>30</span><span class=p>))[::</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>2</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>r_schw</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>real</span><span class=p>(</span><span class=n>lambertw</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>r_tort</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>t_val</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>t_vals</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>R</span><span class=p>,</span> <span class=n>T</span> <span class=o>=</span> <span class=n>kruskal_coords</span><span class=p>(</span><span class=n>r_schw</span><span class=p>,</span> <span class=n>t_val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fn</span> <span class=o>=</span> <span class=s1>&#39;data/ss&#39;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=o>+</span><span class=s1>&#39;.csv&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>np</span><span class=o>.</span><span class=n>savetxt</span><span class=p>(</span><span class=n>fn</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>stack</span><span class=p>((</span><span class=n>R</span><span class=p>,</span> <span class=n>T</span><span class=p>))</span><span class=o>.</span><span class=n>T</span><span class=p>,</span>
</span></span><span class=line><span class=cl>               <span class=n>delimiter</span><span class=o>=</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%f</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>header</span><span class=o>=</span><span class=s2>&#34;R,T&#34;</span><span class=p>,</span> <span class=n>comments</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;{&#39;</span><span class=o>+</span><span class=n>fn</span><span class=o>+</span><span class=s1>&#39;},&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>As you can immediately see from the Penrose diagram, the Schwarzschild time slices intersect at the bifurcation sphere, $\mathcal{B}$ and at spatial infinity $i^0$. When you&rsquo;re interested in behavior of fields near the black hole and far away from it (say, to study gravitational waves), it&rsquo;s better to use non-intersecting time slices.</p><p>Most useful time functions are related to the Schwarzschild time by a shift in height that depends only on the radial coordinate:
$$ t \to t + h(r). $$
For example, the height function for <a href=https://en.wikipedia.org/wiki/Gullstrand%E2%80%93Painlev%C3%A9_coordinates target=_blank rel=noopener>Gullstrand–Painlevé</a> coordinates is
$$ h_{\rm GP} (r) = -2 \sqrt{r} + \ln\frac{\sqrt{r}+1}{\sqrt{r}-1}. $$
Note that the height function is singular at the horizon. This singularity is needed to counteract the singularity of Schwarzschild time slices near the bifurcation sphere. Gullstrand–Painlevé gives a nice foliation of the future event horizon, $\mathcal{H}^+$. But you can also see that the time slices still intersect at spatial infinity.</p><table><thead><tr><th style=text-align:center></th><th style=text-align:center></th></tr></thead><tbody><tr><td style=text-align:center><figure id=figure-schwarzschild-droste-time-slices><div class="d-flex justify-content-center"><div class=w-100><img alt="Schwarzschild-Droste time slices" srcset="/post/drawing-penrose-diagrams/figures/ss_standard_hu727494f74e41712379bdfed7d71bfe07_305624_e40ae1b1bcf9878a0ebd29d8891af4da.webp 400w,
/post/drawing-penrose-diagrams/figures/ss_standard_hu727494f74e41712379bdfed7d71bfe07_305624_ac19cab7f13834bfd457c9df7e2072af.webp 760w,
/post/drawing-penrose-diagrams/figures/ss_standard_hu727494f74e41712379bdfed7d71bfe07_305624_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/drawing-penrose-diagrams/figures/ss_standard_hu727494f74e41712379bdfed7d71bfe07_305624_e40ae1b1bcf9878a0ebd29d8891af4da.webp width=760 height=760 loading=lazy data-zoomable></div></div><figcaption>Schwarzschild-Droste time slices</figcaption></figure></td><td style=text-align:center><figure id=figure-gullstrandpainlevé-time-slices><div class="d-flex justify-content-center"><div class=w-100><img alt="Gullstrand–Painlevé time slices" srcset="/post/drawing-penrose-diagrams/figures/ss_gp_huc45694372c238d974acb5d587f3bbeb8_320514_627235e3a36de0231d5f308663c9288a.webp 400w,
/post/drawing-penrose-diagrams/figures/ss_gp_huc45694372c238d974acb5d587f3bbeb8_320514_e6bc86a8e8efe39e055b87f72c278f9b.webp 760w,
/post/drawing-penrose-diagrams/figures/ss_gp_huc45694372c238d974acb5d587f3bbeb8_320514_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/drawing-penrose-diagrams/figures/ss_gp_huc45694372c238d974acb5d587f3bbeb8_320514_627235e3a36de0231d5f308663c9288a.webp width=760 height=760 loading=lazy data-zoomable></div></div><figcaption>Gullstrand–Painlevé time slices</figcaption></figure></td></tr></tbody></table><p>We need a height function that&rsquo;s singular both near and far from the black hole. This idea underlies the construction of hyperboloidal coordinates. For example,
$$ h_{\rm Hyp} (r) = \sqrt{1+ r_\ast^2}, $$
gives the hyperboloidal foliation on the left panel. The slices do not intersect. Instead, you get a nice, smooth foliation of the full exterior domain. The minimal gauge of <a href=https://arxiv.org/abs/1809.02837 target=_blank rel=noopener>Ansorg, Jaramillo, and Macedo</a> with the height function
$$ h_{\rm MG} (r) = r + 2 \ln r - \ln(r - 1), $$
has a similar behavior as depicted on the right panel.</p><table><thead><tr><th style=text-align:center></th><th style=text-align:center></th></tr></thead><tbody><tr><td style=text-align:center><figure id=figure-hyperbolic-time-slices><div class="d-flex justify-content-center"><div class=w-100><img alt="Hyperbolic time slices" srcset="/post/drawing-penrose-diagrams/figures/ss_hyperbolic_hu727494f74e41712379bdfed7d71bfe07_267505_619c70a07d8ef7fd1fa8eac3ec505535.webp 400w,
/post/drawing-penrose-diagrams/figures/ss_hyperbolic_hu727494f74e41712379bdfed7d71bfe07_267505_cf6b5d0752b76d74c305fe585553582f.webp 760w,
/post/drawing-penrose-diagrams/figures/ss_hyperbolic_hu727494f74e41712379bdfed7d71bfe07_267505_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/drawing-penrose-diagrams/figures/ss_hyperbolic_hu727494f74e41712379bdfed7d71bfe07_267505_619c70a07d8ef7fd1fa8eac3ec505535.webp width=760 height=760 loading=lazy data-zoomable></div></div><figcaption>Hyperbolic time slices</figcaption></figure></td><td style=text-align:center><figure id=figure-minimal-gauge><div class="d-flex justify-content-center"><div class=w-100><img alt="Minimal gauge" srcset="/post/drawing-penrose-diagrams/figures/ss_minimal_hu727494f74e41712379bdfed7d71bfe07_260868_edd5824f8e851782d2c357d381a0ccf6.webp 400w,
/post/drawing-penrose-diagrams/figures/ss_minimal_hu727494f74e41712379bdfed7d71bfe07_260868_c34845ff30f7a4ae6610769aa013eeb2.webp 760w,
/post/drawing-penrose-diagrams/figures/ss_minimal_hu727494f74e41712379bdfed7d71bfe07_260868_1200x1200_fit_q75_h2_lanczos_3.webp 1200w" src=/post/drawing-penrose-diagrams/figures/ss_minimal_hu727494f74e41712379bdfed7d71bfe07_260868_edd5824f8e851782d2c357d381a0ccf6.webp width=760 height=760 loading=lazy data-zoomable></div></div><figcaption>Minimal gauge</figcaption></figure></td></tr></tbody></table><p>Similar constructions can be made also for Kerr, Reissner–Nordström, or Schwarzschild-de Sitter metrics. If you have any questions about the diagrams or the source files, feel free to email me at <a href=mailto:anil@umd.edu>anil@umd.edu</a>.</p><p>I plan to write two more posts on Penrose compactification. Stay tuned!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>For a rigorous, mathematical definition of Penrose diagrams, see the Appendix C.2 in a <a href=https://arxiv.org/abs/gr-qc/0309115 target=_blank rel=noopener>paper</a> by Dafermos and Rodnianski.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>The curious capitalization of TikZ derives from the capitalization of the German expression &ldquo;TikZ is kein Zeichenprogramm.&rdquo;&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=article-tags><a class="badge badge-light" href=/tag/infinity/>infinity</a>
<a class="badge badge-light" href=/tag/penrose/>penrose</a>
<a class="badge badge-light" href=/tag/tikz/>tikz</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https://hyperboloid.al/post/drawing-penrose-diagrams/&text=How%20to%20draw%20Penrose%20diagrams" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https://hyperboloid.al/post/drawing-penrose-diagrams/&t=How%20to%20draw%20Penrose%20diagrams" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=How%20to%20draw%20Penrose%20diagrams&body=https://hyperboloid.al/post/drawing-penrose-diagrams/" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https://hyperboloid.al/post/drawing-penrose-diagrams/&title=How%20to%20draw%20Penrose%20diagrams" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=How%20to%20draw%20Penrose%20diagrams%20https://hyperboloid.al/post/drawing-penrose-diagrams/" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https://hyperboloid.al/post/drawing-penrose-diagrams/&title=How%20to%20draw%20Penrose%20diagrams" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2022 Anıl Zenginoğlu. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.46271ef31da3f018e9cd1b59300aa265.js></script>
<script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.c251366b4128fd5e6b046d4c97a62a51.js type=module></script>
<script src=/en/js/wowchemy.min.a6238d5886fa4a2f7cf92df25709326f.js></script>
<script src=/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js type=module></script></body></html>